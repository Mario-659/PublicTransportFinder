<html>
<head>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
  <style type="text/css">
    html { height: 100% }
    body { height: 100%; margin: 0px; padding: 0px }
    #map_canvas { height: 100%; background-color: #666970; }
  </style>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC5Ai7YRP75d-XTlDhpt-ORGVj1WySzPok&callback=initMap"></script>
  </script>
  <script type="text/javascript">
    function initialize() {
      var latlng = new google.maps.LatLng(51.107883, 17.038538);
      var myOptions = {
        zoom: 12,
        center: latlng,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        mapTypeControl: false,
        navigationControl: false,
        streetViewControl: false,
        fullscreenControl: false,
        backgroundColor: "#666970"
      };

      document.geocoder = new google.maps.Geocoder();
      document.map = new google.maps.Map(document.getElementById("map_canvas"),myOptions);

      let busMarkers = [];
      let tramMarkers = [];

      function addMarker(x, y, line, markersArray, markerStyling){
        var marker = new google.maps.Marker({
          position: new google.maps.LatLng(x, y),
          map: document.map,
          label: Object.assign(markerStyling.label, {text: line.toUpperCase()}),
          icon: markerStyling.icon,
          optimized: true
        });
        markersArray.push(marker);
      }

      function extractMarkers(lines, markersArray, markerStyling){
        for (let i = 0; i < lines.length; i++) {
          for (let j = 0; j < lines[i].length; j++) {
            addMarker(lines[i][j].x, lines[i][j].y, lines[i][j].name, markersArray, markerStyling)
          }
        }
      }

      document.setMarkers = function setMarkers(lines, markersArray, markerStyling) {
        deleteMarkers(markersArray);
        extractMarkers(lines, markersArray, markerStyling);
      }

      document.setBusMarkers = function setBusMarkers(lines){
        document.setMarkers(lines, busMarkers, busMarkerStyling)
      }

      document.setTramMarkers = function setTramMarkers(lines){
        document.setMarkers(lines, tramMarkers, tramMarkerStyling)
      }


      function setMapOnAll(markers, map) {
        for ( let i=0; i<markers.length; i++){
          markers[i].setMap(map);
        }
      }

      function deleteMarkers(markersArray){
        setMapOnAll(markersArray, null);
        markersArray = null;
      }

      const busMarkerStyling = {
        icon: {
          url: "images/busMarkerV2.png",
          scaledSize: new google.maps.Size(17, 28),
          labelOrigin: new google.maps.Point(8.5, 10)
        },
        label: {
          color: "black",
          fontSize: '9px'
        }
      };

      const tramMarkerStyling = {
        icon: {
          url: "images/tramMarkerV2.png",
          scaledSize: new google.maps.Size(17, 28),
          labelOrigin: new google.maps.Point(8.5, 10)
        },
        label: {
          color: "black",
          fontSize: '9px'
        }
      };

      document.zoomIn = function zoomIn() {
        var zoomLevel = document.map.getZoom();
        if (zoomLevel <= 20) document.map.setZoom(zoomLevel + 1);
      }

      document.zoomOut = function zoomOut() {
        var zoomLevel = document.map.getZoom();
        if (zoomLevel > 0) document.map.setZoom(zoomLevel - 1);
      }

      document.setMapTypeGrey = function setMapTypeGrey() {
        document.map.setOptions( {styles: MapStyleGrey})
        document.map.setMapTypeId(google.maps.MapTypeId.ROADMAP);
      }

      document.setMapTypeDark = function setMapTypeDark() {
        document.map.setOptions( {styles: MapStyleDark})
        document.map.setMapTypeId(google.maps.MapTypeId.ROADMAP);
      }

      document.setMapTypeRoad = function setMapTypeRoad() {
        document.map.setOptions( {styles: null})
        document.map.setMapTypeId(google.maps.MapTypeId.ROADMAP);
      }
      document.setMapTypeSatellite = function setMapTypeSatellite() {
        document.map.setOptions( {styles: null})
        document.map.setMapTypeId(google.maps.MapTypeId.SATELLITE);
      }
      document.setMapTypeHybrid = function setMapTypeHybrid() {
        document.map.setOptions( {styles: null})
        document.map.setMapTypeId(google.maps.MapTypeId.HYBRID);
      }
      document.setMapTypeTerrain = function setMapTypeTerrain() {
        document.map.setOptions( {styles: null})
        document.map.setMapTypeId(google.maps.MapTypeId.TERRAIN);
      }

      const MapStyleDark = [
        {
          "featureType": "administrative",
          "elementType": "labels.text.fill",
          "stylers": [
            {
              "color": "#444444"
            }
          ]
        },
        {
          "featureType": "landscape",
          "elementType": "all",
          "stylers": [
            {
              "color": "#44475a"
            }
          ]
        },
        {
          "featureType": "poi",
          "elementType": "all",
          "stylers": [
            {
              "visibility": "off"
            }
          ]
        },
        {
          "featureType": "road",
          "elementType": "all",
          "stylers": [
            {
              "saturation": -100
            },
            {
              "lightness": 45
            }
          ]
        },
        {
          "featureType": "road.highway",
          "elementType": "all",
          "stylers": [
            {
              "visibility": "simplified"
            }
          ]
        },
        {
          "featureType": "road.arterial",
          "elementType": "labels.icon",
          "stylers": [
            {
              "visibility": "off"
            }
          ]
        },
        {
          "featureType": "transit",
          "elementType": "all",
          "stylers": [
            {
              "visibility": "off"
            }
          ]
        },
        {
          "featureType": "water",
          "elementType": "all",
          "stylers": [
            {
              "color": "#46bcec"
            },
            {
              "visibility": "on"
            }
          ]
        }
      ]

      const MapStyleGrey = [
        {
          "featureType": "administrative",
          "elementType": "labels.text.fill",
          "stylers": [
            {
              "color": "#444444"
            }
          ]
        },
        {
          "featureType": "landscape",
          "elementType": "all",
          "stylers": [
            {
              "color": "#f2f2f2"
            }
          ]
        },
        {
          "featureType": "poi",
          "elementType": "all",
          "stylers": [
            {
              "visibility": "off"
            }
          ]
        },
        {
          "featureType": "road",
          "elementType": "all",
          "stylers": [
            {
              "saturation": -100
            },
            {
              "lightness": 45
            }
          ]
        },
        {
          "featureType": "road.highway",
          "elementType": "all",
          "stylers": [
            {
              "visibility": "simplified"
            }
          ]
        },
        {
          "featureType": "road.arterial",
          "elementType": "labels.icon",
          "stylers": [
            {
              "visibility": "off"
            }
          ]
        },
        {
          "featureType": "transit",
          "elementType": "all",
          "stylers": [
            {
              "visibility": "off"
            }
          ]
        },
        {
          "featureType": "water",
          "elementType": "all",
          "stylers": [
            {
              "color": "#46bcec"
            },
            {
              "visibility": "on"
            }
          ]
        }
      ]
      document.setMapTypeGrey();
    }
  </script>
</head>
<body onload="initialize()">
<div id="map_canvas" style="width:100%; height:100%"></div>
</body>
</html>